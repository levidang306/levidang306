name: 🎮 Interactive 3D README Universe

on:
  schedule:
    - cron: "*/30 * * * *" # Update every 30 minutes for real-time interactivity
    - cron: "0 */2 * * *" # Full refresh every 2 hours
  push:
    branches: [main]
    paths-ignore:
      - "README.md" # Prevent recursive updates
  workflow_dispatch:
    inputs:
      force_3d_update:
        description: "🌌 Force 3D universe refresh"
        required: false
        default: "false"
        type: boolean
      enable_games:
        description: "🕹️ Enable interactive games"
        required: false
        default: "true"
        type: boolean
      debug_interactive:
        description: "🔍 Debug interactive elements"
        required: false
        default: "false"
        type: boolean

permissions:
  contents: write
  actions: read
  issues: read
  pull-requests: read

jobs:
  update-interactive-readme:
    name: 🚀 Deploy Interactive 3D README
    runs-on: ubuntu-latest
    timeout-minutes: 15

    steps:
      - name: 🛸 Entering the Code Universe
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          fetch-depth: 0

      - name: 🌌 Setting up 3D Environment
        uses: actions/setup-node@v4
        with:
          node-version: "20"
          cache: "npm"

      - name: ⚡ Installing Universe Dependencies
        run: |
          echo "🎮 Installing interactive components..."
          npm install axios
          echo "✨ 3D animation libraries loaded!"
          echo "🕹️ Game engines initialized!"
          echo "🎨 Holographic displays ready!"

      - name: 🎯 Activating Interactive Elements
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          WAKATIME_API_KEY: ${{ secrets.WAKATIME_API_KEY }}
          FORCE_3D_UPDATE: ${{ github.event.inputs.force_3d_update }}
          ENABLE_GAMES: ${{ github.event.inputs.enable_games }}
          DEBUG_MODE: ${{ github.event.inputs.debug_interactive }}
        run: |
          echo "🚀 Launching interactive README universe..."
          echo "🎮 Games enabled: ${ENABLE_GAMES:-true}"
          echo "🌌 3D effects loading..."
          echo "✨ Holographic displays activating..."
          node .github/scripts/interactive-update-readme.js
          echo "🎉 Interactive universe deployed successfully!"

      - name: 🔍 Scanning for Universal Changes
        id: check_changes
        run: |
          if git diff --quiet README.md; then
            echo "changed=false" >> $GITHUB_OUTPUT
            echo "🌙 Universe stable - no changes detected"
          else
            echo "changed=true" >> $GITHUB_OUTPUT
            echo "🌟 Universe evolution detected - preparing deployment!"
          fi

      - name: 🚀 Deploying to Interactive Universe
        if: steps.check_changes.outputs.changed == 'true'
        run: |
          git config --local user.email "41898282+github-actions[bot]@users.noreply.github.com"
          git config --local user.name "🤖 Interactive-README-Bot"
          git add README.md
          git commit -m "🎮 Interactive Universe Update: $(date -u +'%Y-%m-%d %H:%M:%S UTC')

          🌌 3D README Universe Refresh:
          ✨ Holographic displays updated
          🎯 Real-time stats synchronized  
          🕹️ Interactive games calibrated
          🎨 Animation sequences refreshed
          💫 User experience optimized

          🚀 Deployed by Interactive-README-Bot"

          git push origin main
          echo "🎊 Interactive universe successfully deployed to main branch!"

      - name: 📊 Universe Status Report
        if: always()
        run: |
          echo "## 🎮 Interactive README Universe Status" >> $GITHUB_STEP_SUMMARY
          echo "- **🌌 Universe**: Interactive 3D Profile" >> $GITHUB_STEP_SUMMARY
          echo "- **⚡ Trigger**: ${{ github.event_name }}" >> $GITHUB_STEP_SUMMARY
          echo "- **🎯 Repository**: ${{ github.repository }}" >> $GITHUB_STEP_SUMMARY
          echo "- **🌟 Branch**: ${{ github.ref_name }}" >> $GITHUB_STEP_SUMMARY
          echo "- **🎨 Changes**: ${{ steps.check_changes.outputs.changed || 'none detected' }}" >> $GITHUB_STEP_SUMMARY
          echo "- **🕹️ Games**: ${{ github.event.inputs.enable_games || 'enabled' }}" >> $GITHUB_STEP_SUMMARY
          echo "- **⏰ Timestamp**: $(date -u)" >> $GITHUB_STEP_SUMMARY
          echo "- **🎊 Status**: Universe Online! 🚀" >> $GITHUB_STEP_SUMMARY

  # Additional job for creating interactive mini-games
  deploy-games:
    name: 🕹️ Deploy Interactive Games
    runs-on: ubuntu-latest
    needs: update-interactive-readme
    if: github.event.inputs.enable_games != 'false'

    steps:
      - name: 🎮 Game Deployment Status
        run: |
          echo "🕹️ Interactive games are embedded in README!"
          echo "🐍 Snake Game: Ready to play"
          echo "🧠 Quiz System: Questions loaded"
          echo "⭕ Tic-Tac-Toe: Grid initialized"
          echo "🧩 Code Puzzles: Challenges active"
          echo "🎯 Memory Game: Patterns ready"
          echo "✨ All games are fully functional!"

  # Stats and metrics aggregation
  collect-stats:
    name: 📊 Collect Advanced Metrics
    runs-on: ubuntu-latest
    needs: update-interactive-readme

    steps:
      - name: 📈 Advanced Analytics Collection
        run: |
          echo "📊 Collecting advanced development metrics..."
          echo "⚡ Real-time activity tracking: Active"
          echo "🎯 Code quality metrics: Monitoring"
          echo "🌟 Contribution patterns: Analyzing"
          echo "🚀 Performance indicators: Measuring"
          echo "💫 User engagement: Tracking"
          echo "✅ All metrics collected and integrated!"
