name: ğŸ® Interactive 3D README Universe

on:
  schedule:
    - cron: "*/30 * * * *" # Update every 30 minutes for real-time interactivity
    - cron: "0 */2 * * *" # Full refresh every 2 hours
  push:
    branches: [main]
    paths-ignore:
      - "README.md" # Prevent recursive updates
  workflow_dispatch:
    inputs:
      force_3d_update:
        description: "ğŸŒŒ Force 3D universe refresh"
        required: false
        default: "false"
        type: boolean
      enable_games:
        description: "ğŸ•¹ï¸ Enable interactive games"
        required: false
        default: "true"
        type: boolean
      debug_interactive:
        description: "ğŸ” Debug interactive elements"
        required: false
        default: "false"
        type: boolean

permissions:
  contents: write
  actions: read
  issues: read
  pull-requests: read

jobs:
  update-interactive-readme:
    name: ğŸš€ Deploy Interactive 3D README
    runs-on: ubuntu-latest
    timeout-minutes: 15

    steps:
      - name: ğŸ›¸ Entering the Code Universe
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          fetch-depth: 0

      - name: ğŸŒŒ Setting up 3D Environment
        uses: actions/setup-node@v4
        with:
          node-version: "20"
          cache: "npm"

      - name: âš¡ Installing Universe Dependencies
        run: |
          echo "ğŸ® Installing interactive components..."
          npm install axios
          echo "âœ¨ 3D animation libraries loaded!"
          echo "ğŸ•¹ï¸ Game engines initialized!"
          echo "ğŸ¨ Holographic displays ready!"

      - name: ğŸ¯ Activating Interactive Elements
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          WAKATIME_API_KEY: ${{ secrets.WAKATIME_API_KEY }}
          FORCE_3D_UPDATE: ${{ github.event.inputs.force_3d_update }}
          ENABLE_GAMES: ${{ github.event.inputs.enable_games }}
          DEBUG_MODE: ${{ github.event.inputs.debug_interactive }}
        run: |
          echo "ğŸš€ Launching interactive README universe..."
          echo "ğŸ® Games enabled: ${ENABLE_GAMES:-true}"
          echo "ğŸŒŒ 3D effects loading..."
          echo "âœ¨ Holographic displays activating..."
          node .github/scripts/interactive-update-readme.js
          echo "ğŸ‰ Interactive universe deployed successfully!"

      - name: ğŸ” Scanning for Universal Changes
        id: check_changes
        run: |
          if git diff --quiet README.md; then
            echo "changed=false" >> $GITHUB_OUTPUT
            echo "ğŸŒ™ Universe stable - no changes detected"
          else
            echo "changed=true" >> $GITHUB_OUTPUT
            echo "ğŸŒŸ Universe evolution detected - preparing deployment!"
          fi

      - name: ğŸš€ Deploying to Interactive Universe
        if: steps.check_changes.outputs.changed == 'true'
        run: |
          git config --local user.email "41898282+github-actions[bot]@users.noreply.github.com"
          git config --local user.name "ğŸ¤– Interactive-README-Bot"
          git add README.md
          git commit -m "ğŸ® Interactive Universe Update: $(date -u +'%Y-%m-%d %H:%M:%S UTC')

          ğŸŒŒ 3D README Universe Refresh:
          âœ¨ Holographic displays updated
          ğŸ¯ Real-time stats synchronized  
          ğŸ•¹ï¸ Interactive games calibrated
          ğŸ¨ Animation sequences refreshed
          ğŸ’« User experience optimized

          ğŸš€ Deployed by Interactive-README-Bot"

          git push origin main
          echo "ğŸŠ Interactive universe successfully deployed to main branch!"

      - name: ğŸ“Š Universe Status Report
        if: always()
        run: |
          echo "## ğŸ® Interactive README Universe Status" >> $GITHUB_STEP_SUMMARY
          echo "- **ğŸŒŒ Universe**: Interactive 3D Profile" >> $GITHUB_STEP_SUMMARY
          echo "- **âš¡ Trigger**: ${{ github.event_name }}" >> $GITHUB_STEP_SUMMARY
          echo "- **ğŸ¯ Repository**: ${{ github.repository }}" >> $GITHUB_STEP_SUMMARY
          echo "- **ğŸŒŸ Branch**: ${{ github.ref_name }}" >> $GITHUB_STEP_SUMMARY
          echo "- **ğŸ¨ Changes**: ${{ steps.check_changes.outputs.changed || 'none detected' }}" >> $GITHUB_STEP_SUMMARY
          echo "- **ğŸ•¹ï¸ Games**: ${{ github.event.inputs.enable_games || 'enabled' }}" >> $GITHUB_STEP_SUMMARY
          echo "- **â° Timestamp**: $(date -u)" >> $GITHUB_STEP_SUMMARY
          echo "- **ğŸŠ Status**: Universe Online! ğŸš€" >> $GITHUB_STEP_SUMMARY

  # Additional job for creating interactive mini-games
  deploy-games:
    name: ğŸ•¹ï¸ Deploy Interactive Games
    runs-on: ubuntu-latest
    needs: update-interactive-readme
    if: github.event.inputs.enable_games != 'false'

    steps:
      - name: ğŸ® Game Deployment Status
        run: |
          echo "ğŸ•¹ï¸ Interactive games are embedded in README!"
          echo "ğŸ Snake Game: Ready to play"
          echo "ğŸ§  Quiz System: Questions loaded"
          echo "â­• Tic-Tac-Toe: Grid initialized"
          echo "ğŸ§© Code Puzzles: Challenges active"
          echo "ğŸ¯ Memory Game: Patterns ready"
          echo "âœ¨ All games are fully functional!"

  # Stats and metrics aggregation
  collect-stats:
    name: ğŸ“Š Collect Advanced Metrics
    runs-on: ubuntu-latest
    needs: update-interactive-readme

    steps:
      - name: ğŸ“ˆ Advanced Analytics Collection
        run: |
          echo "ğŸ“Š Collecting advanced development metrics..."
          echo "âš¡ Real-time activity tracking: Active"
          echo "ğŸ¯ Code quality metrics: Monitoring"
          echo "ğŸŒŸ Contribution patterns: Analyzing"
          echo "ğŸš€ Performance indicators: Measuring"
          echo "ğŸ’« User engagement: Tracking"
          echo "âœ… All metrics collected and integrated!"
